import numpy as np
from collections import namedtuple


Atom = namedtuple("Atom", ["name", "pos", "element"])


# single letter code
letter_code = {
    "A": "ALA", "V": "VAL", "I": "ILE", "L": "LEU", "M": "MET", "F": "PHE",
    "Y": "TYR", "W": "TRP", "S": "SER", "T": "THR", "N": "ASN", "Q": "GLN",
    "R": "ARG", "H": "HIS", "K": "LYS", "D": "ASP", "E": "GLU", "C": "CYS",
    "G": "GLY", "P": "PRO",
}


# generated code for amino acid stuctures:
# (generated by structures_codegen.py)
structures = {
    "ALA": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.30046343e+00, 6.51155795e-01, 1.11022302e-16]), "C"),
        Atom("C", np.array([ 2.43471615, -0.34439732,  0.30742603]), "C"),
        Atom("O", np.array([ 2.19766825, -1.4154634 ,  0.86373238]), "O"),
        Atom("CB", np.array([1.27803648, 1.80995593, 0.99663297]), "C"),
        Atom("N_next", np.array([ 3.68636895e+00, -1.41553436e-15,  0.00000000e+00]), "N"),
    ],
    "ARG": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.21525801e+00, 8.48517509e-01, 9.71445147e-17]), "C"),
        Atom("C", np.array([2.33197911, 0.02401683, 0.62715439]), "C"),
        Atom("O", np.array([ 2.12902616, -0.59317586,  1.67238034]), "O"),
        Atom("CB", np.array([0.98208393, 2.12797805, 0.80188627]), "C"),
        Atom("CG", np.array([2.14717995, 3.10284271, 0.77354599]), "C"),
        Atom("CD", np.array([ 2.34772727,  3.68362773, -0.61579577]), "C"),
        Atom("NE", np.array([ 1.16197431,  4.39381435, -1.08679351]), "N"),
        Atom("CZ", np.array([ 0.92700291,  5.68353303, -0.86619163]), "C"),
        Atom("NH1", np.array([ 1.79678337,  6.41047422, -0.17875912]), "N"),
        Atom("NH2", np.array([-0.17933497,  6.24593034, -1.33243916]), "N"),
        Atom("N_next", np.array([ 3.51634711e+00, -4.44089210e-16,  3.33066907e-16]), "N"),
    ],
    "ASN": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.27750424e+00, 7.03031238e-01, 5.55111512e-17]), "C"),
        Atom("C", np.array([ 2.38067377, -0.29098115,  0.35247603]), "C"),
        Atom("O", np.array([ 2.11622594, -1.31371063,  0.97973574]), "O"),
        Atom("CB", np.array([1.24857006, 1.86899868, 0.99744761]), "C"),
        Atom("CG", np.array([2.38829221, 2.84033834, 0.77431159]), "C"),
        Atom("OD1", np.array([2.28077946, 3.78101915, 0.00795356]), "O"),
        Atom("ND2", np.array([3.51669912, 2.66710904, 1.41729096]), "N"),
        Atom("N_next", np.array([ 3.62502124e+00, -4.44089210e-16,  2.22044605e-16]), "N"),
    ],
    "ASP": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.32409571, 0.62520681, 0.        ]), "C"),
        Atom("C", np.array([ 2.43154502, -0.4301078 ,  0.13012727]), "C"),
        Atom("O", np.array([ 2.17087098, -1.61644265,  0.3436704 ]), "O"),
        Atom("CB", np.array([1.42338039, 1.67799858, 1.12535818]), "C"),
        Atom("CG", np.array([2.24250082, 2.90603087, 0.69180609]), "C"),
        Atom("OD1", np.array([3.40132113, 2.75455618, 0.23621977]), "O"),
        Atom("OD2", np.array([1.73441769, 4.04409059, 0.7909656 ]), "O"),
        Atom("N_next", np.array([ 3.68550322e+00, -2.22044605e-16,  0.00000000e+00]), "N"),
    ],
    "CYS": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([ 1.28384861e+00,  6.93211902e-01, -1.11022302e-16]), "C"),
        Atom("C", np.array([ 2.41732109, -0.253027  ,  0.443741  ]), "C"),
        Atom("O", np.array([ 2.17746684, -1.22576196,  1.16121479]), "O"),
        Atom("CB", np.array([1.16806073, 1.94867666, 0.8795558 ]), "C"),
        Atom("SG", np.array([2.62137588, 3.03470586, 0.91334434]), "S"),
        Atom("N_next", np.array([ 3.64921608e+00, -7.77156117e-16,  2.22044605e-16]), "N"),
    ],
    "GLN": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([ 1.23460442e+00,  7.67512171e-01, -1.38777878e-17]), "C"),
        Atom("C", np.array([ 2.35128275, -0.12672773,  0.52610502]), "C"),
        Atom("O", np.array([ 2.10461888, -0.9421828 ,  1.40743808]), "O"),
        Atom("CB", np.array([0.97057289, 2.02821204, 0.840065  ]), "C"),
        Atom("CG", np.array([2.19289313, 2.86713558, 1.19914231]), "C"),
        Atom("CD", np.array([ 2.82707002,  3.46405825, -0.04041729]), "C"),
        Atom("OE1", np.array([ 3.54067404,  2.81066708, -0.78372631]), "O"),
        Atom("NE2", np.array([ 2.59234746,  4.7280076 , -0.30112086]), "N"),
        Atom("N_next", np.array([ 3.56409708e+00, -5.55111512e-16,  0.00000000e+00]), "N"),
    ],
    "GLU": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([ 1.30548591e+00,  6.48265016e-01, -2.42861287e-17]), "C"),
        Atom("C", np.array([ 2.42392472, -0.27870481,  0.46897608]), "C"),
        Atom("O", np.array([ 2.19430168, -1.21733382,  1.23129546]), "O"),
        Atom("CB", np.array([1.27379901, 1.91414053, 0.85951564]), "C"),
        Atom("CG", np.array([0.30933028, 2.97629617, 0.3564953 ]), "C"),
        Atom("CD", np.array([0.27187821, 4.20133395, 1.24839987]), "C"),
        Atom("OE1", np.array([-0.49845086,  5.13675966,  0.94275815]), "O"),
        Atom("OE2", np.array([1.01105822, 4.2300443 , 2.25417402]), "O"),
        Atom("N_next", np.array([ 3.63494003e+00, -1.11022302e-15,  1.66533454e-16]), "N"),
    ],
    "GLY": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([ 1.33296855e+00,  6.09122192e-01, -5.55111512e-17]), "C"),
        Atom("C", np.array([ 2.46804792, -0.3798421 , -0.31132854]), "C"),
        Atom("O", np.array([ 2.25524676, -1.48503537, -0.81335294]), "O"),
        Atom("N_next", np.array([3.70621572e+00, 3.60822483e-16, 5.55111512e-17]), "N"),
    ],
    "HIS": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.27625721, 0.72386845, 0.        ]), "C"),
        Atom("C", np.array([ 2.42074515, -0.13319886,  0.545891  ]), "C"),
        Atom("O", np.array([ 2.21288863, -0.9159552 ,  1.46719289]), "O"),
        Atom("CB", np.array([1.10007212, 2.01078666, 0.80315711]), "C"),
        Atom("CG", np.array([2.34024734, 2.85683326, 0.86922215]), "C"),
        Atom("ND1", np.array([3.06307648, 3.12730381, 2.02979861]), "N"),
        Atom("CD2", np.array([ 2.96270868,  3.44059572, -0.19284295]), "C"),
        Atom("CE1", np.array([4.1091891 , 3.87196705, 1.64110973]), "C"),
        Atom("NE2", np.array([4.07153251, 4.07761421, 0.31488153]), "N"),
        Atom("N_next", np.array([3.63014834e+00, 8.88178420e-16, 2.22044605e-16]), "N"),
    ],
    "ILE": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.15861138e+00, 9.00727857e-01, 8.32667268e-17]), "C"),
        Atom("C", np.array([2.31023578, 0.18313027, 0.70050406]), "C"),
        Atom("O", np.array([ 2.20885372, -0.17580899,  1.87577649]), "O"),
        Atom("CB", np.array([0.8772165 , 2.24812408, 0.70882886]), "C"),
        Atom("CG1", np.array([-0.35707379,  3.00943813,  0.18189963]), "C"),
        Atom("CG2", np.array([2.12693667, 3.15023561, 0.64136573]), "C"),
        Atom("CD1", np.array([-0.33377297,  3.35469936, -1.30640032]), "C"),
        Atom("N_next", np.array([ 3.42666149e+00, -2.22044605e-16, -2.22044605e-16]), "N"),
    ],
    "LEU": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.33657675e+00, 6.05818124e-01, 1.11022302e-16]), "C"),
        Atom("C", np.array([ 2.47337566, -0.36225458,  0.37450831]), "C"),
        Atom("O", np.array([ 2.23919319, -1.40371922,  0.98804313]), "O"),
        Atom("CB", np.array([1.353531  , 1.82563197, 0.93034227]), "C"),
        Atom("CG", np.array([2.42213708, 2.89724891, 0.702849  ]), "C"),
        Atom("CD1", np.array([ 2.30935592,  3.47695866, -0.69875223]), "C"),
        Atom("CD2", np.array([2.31186494, 3.99455378, 1.75192625]), "C"),
        Atom("N_next", np.array([ 3.69865854e+00, -6.66133815e-16, -2.22044605e-16]), "N"),
    ],
    "LYS": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.21841756e+00, 8.10963410e-01, 1.38777878e-17]), "C"),
        Atom("C", np.array([2.3714623 , 0.05040264, 0.6286622 ]), "C"),
        Atom("O", np.array([ 2.20161636, -0.52208031,  1.69587428]), "O"),
        Atom("CB", np.array([0.89322648, 2.11524854, 0.74700206]), "C"),
        Atom("CG", np.array([1.87830286, 3.22161491, 0.37923177]), "C"),
        Atom("CD", np.array([1.63535908, 4.51905319, 1.16356348]), "C"),
        Atom("CE", np.array([2.62846842, 5.59157278, 0.68514571]), "C"),
        Atom("NZ", np.array([2.44878031, 6.8876376 , 1.39071936]), "N"),
        Atom("N_next", np.array([ 3.53966665e+00,  0.00000000e+00, -1.11022302e-16]), "N"),
    ],
    "MET": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.28035932e+00, 6.78312612e-01, 1.11022302e-16]), "C"),
        Atom("C", np.array([ 2.36950528, -0.35869624,  0.2229792 ]), "C"),
        Atom("O", np.array([ 2.07257133, -1.50551532,  0.5541351 ]), "O"),
        Atom("CB", np.array([1.2654866 , 1.81583597, 1.02108786]), "C"),
        Atom("CG", np.array([1.15232427, 1.36833792, 2.47247368]), "C"),
        Atom("SD", np.array([1.13870877, 2.77687244, 3.59344831]), "S"),
        Atom("CE", np.array([1.3048026 , 1.90512133, 5.16241958]), "C"),
        Atom("N_next", np.array([3.63020123e+00, 8.32667268e-16, 2.22044605e-16]), "N"),
    ],
    "PHE": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.28547598e+00, 6.91150851e-01, 1.11022302e-16]), "C"),
        Atom("C", np.array([ 2.40202956, -0.21594172,  0.53101146]), "C"),
        Atom("O", np.array([ 2.19230812, -1.0570347 ,  1.41127876]), "O"),
        Atom("CB", np.array([1.12820878, 2.01186863, 0.78491629]), "C"),
        Atom("CG", np.array([2.39846299, 2.6593289 , 1.30963853]), "C"),
        Atom("CD1", np.array([2.62138751, 2.75630467, 2.69480038]), "C"),
        Atom("CD2", np.array([3.35589889, 3.17865133, 0.41933201]), "C"),
        Atom("CE1", np.array([3.80090626, 3.33714309, 3.1859279 ]), "C"),
        Atom("CE2", np.array([4.53660576, 3.75971504, 0.91234038]), "C"),
        Atom("CZ", np.array([4.76417893, 3.83375555, 2.29518616]), "C"),
        Atom("N_next", np.array([3.60234035e+00, 1.33226763e-15, 2.22044605e-16]), "N"),
    ],
    "PRO": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([ 1.26811418e+00,  7.27222399e-01, -1.11022302e-16]), "C"),
        Atom("C", np.array([ 2.41468905, -0.0715248 ,  0.61853212]), "C"),
        Atom("O", np.array([ 2.24678204, -0.69258342,  1.67255841]), "O"),
        Atom("CB", np.array([1.01926103, 2.03643016, 0.75172943]), "C"),
        Atom("CG", np.array([-0.30234232,  1.82827919,  1.49086999]), "C"),
        Atom("CD", np.array([-1.02807697,  0.74421248,  0.69652461]), "C"),
        Atom("N_next", np.array([3.5970089, 0.       , 0.       ]), "N"),
    ],
    "SER": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([ 1.22576454e+00,  8.13727410e-01, -5.55111512e-17]), "C"),
        Atom("C", np.array([2.36902739, 0.08004061, 0.68110478]), "C"),
        Atom("O", np.array([ 2.22296087, -0.41244966,  1.80329456]), "O"),
        Atom("CB", np.array([0.99170942, 2.15691734, 0.6892438 ]), "C"),
        Atom("OG", np.array([2.18608271, 2.91763963, 0.73413308]), "O"),
        Atom("N_next", np.array([ 3.50871629e+00, -6.66133815e-16, -2.22044605e-16]), "N"),
    ],
    "THR": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.24749185e+00, 7.61838621e-01, 1.73472348e-17]), "C"),
        Atom("C", np.array([ 2.34959794, -0.1226484 ,  0.55874133]), "C"),
        Atom("O", np.array([ 2.11784611, -0.88226527,  1.49598692]), "O"),
        Atom("CB", np.array([1.09725231, 2.03931337, 0.83452523]), "C"),
        Atom("OG1", np.array([0.28336714, 2.94036524, 0.11966758]), "O"),
        Atom("CG2", np.array([2.41201211, 2.75865976, 1.14262981]), "C"),
        Atom("N_next", np.array([ 3.54898591e+00,  8.88178420e-16, -1.38777878e-17]), "N"),
    ],
    "TRP": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([ 1.23775142e+00,  7.63748930e-01, -8.67361738e-18]), "C"),
        Atom("C", np.array([ 2.37836938, -0.04621555,  0.61760926]), "C"),
        Atom("O", np.array([ 2.20724575, -0.69158795,  1.65101826]), "O"),
        Atom("CB", np.array([0.99910565, 2.06699545, 0.7647344 ]), "C"),
        Atom("CG", np.array([2.19563798, 2.94519428, 0.91495493]), "C"),
        Atom("CD1", np.array([ 3.01829802,  3.31770592, -0.08785489]), "C"),
        Atom("CD2", np.array([2.74458565, 3.55639283, 2.12236322]), "C"),
        Atom("NE1", np.array([4.0028088 , 4.14415079, 0.40528748]), "N"),
        Atom("CE2", np.array([3.91235602, 4.28996711, 1.76662575]), "C"),
        Atom("CE3", np.array([2.39597468, 3.54403631, 3.48933202]), "C"),
        Atom("CZ2", np.array([4.71368737, 4.94580826, 2.71049939]), "C"),
        Atom("CZ3", np.array([3.19890266, 4.18570367, 4.4527902 ]), "C"),
        Atom("CH2", np.array([4.36224203, 4.87639405, 4.06739911]), "C"),
        Atom("N_next", np.array([ 3.55563398e+00, -6.66133815e-16,  2.22044605e-16]), "N"),
    ],
    "TYR": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.25437668e+00, 7.32502656e-01, 1.11022302e-16]), "C"),
        Atom("C", np.array([ 2.37151006, -0.17732621,  0.51581629]), "C"),
        Atom("O", np.array([ 2.14964244, -1.02946842,  1.37291629]), "O"),
        Atom("CB", np.array([1.09946681, 2.01287116, 0.82894477]), "C"),
        Atom("CG", np.array([2.40507931, 2.65998981, 1.23129718]), "C"),
        Atom("CD1", np.array([3.00590753, 3.62799461, 0.40728373]), "C"),
        Atom("CD2", np.array([3.03151163, 2.26854263, 2.42706707]), "C"),
        Atom("CE1", np.array([4.22155382, 4.2272452 , 0.79723737]), "C"),
        Atom("CE2", np.array([4.23714103, 2.87053716, 2.82539524]), "C"),
        Atom("CZ", np.array([4.82608388, 3.86252923, 2.01751712]), "C"),
        Atom("OH", np.array([5.96300167, 4.47590698, 2.4397856 ]), "O"),
        Atom("N_next", np.array([ 3.58524602e+00, -9.99200722e-16,  2.22044605e-16]), "N"),
    ],
    "VAL": [
        Atom("N", np.array([0., 0., 0.]), "N"),
        Atom("CA", np.array([1.32165812, 0.65854523, 0.        ]), "C"),
        Atom("C", np.array([ 2.4446086 , -0.25126413,  0.4971822 ]), "C"),
        Atom("O", np.array([ 2.2263584 , -1.15515626,  1.3050503 ]), "O"),
        Atom("CB", np.array([1.32770536, 2.0120295 , 0.72895389]), "C"),
        Atom("CG1", np.array([0.028237  , 2.79435223, 0.52392678]), "C"),
        Atom("CG2", np.array([1.56779504, 1.90401039, 2.23193686]), "C"),
        Atom("N_next", np.array([ 3.65141479e+00,  3.33066907e-16, -1.11022302e-16]), "N"),
    ],
}




